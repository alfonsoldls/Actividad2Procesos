package es.cliente;

import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.boot.CommandLineRunner;
import org.springframework.boot.SpringApplication;
import org.springframework.boot.autoconfigure.SpringBootApplication;
import org.springframework.context.ApplicationContext;
import java.util.Scanner;


import es.cliente.servicio.ServicioProxyLibro;
import es.cliente.entidad.*;

@SpringBootApplication
public class ClienteLibreriaApplication implements CommandLineRunner{

	@Autowired
	private ServicioProxyLibro spl;
		
	@Autowired
	private ApplicationContext context;
		
	public static void main(String[] args) {
		System.out.println("Cliente -> Cargando el contexto de Spring");
		SpringApplication.run(ClienteLibreriaApplication.class, args);
	}
	
	@Override
	public void run(String... args) throws Exception {
        Scanner scanner = new Scanner(System.in);
        boolean salir = false;
        int opcion;

        while (!salir) {
        	menu();
            opcion = scanner.nextInt();

            switch (opcion) {
                case 1:
                    // Lógica para dar de alta un libro
                	altaLibro();
                    break;
                case 2:
                    // Lógica para dar de baja un libro por ID
                	bajaLibro();
                    break;
                case 3:
                    // Lógica para modificar un libro por ID
                	modificarLibro();
                    break;
                case 4:
                    // Lógica para obtener un libro por ID
                	obtenerLibro();
                    break;
                case 5:
                    // Lógica para listar todos los libros
                	listarLibreria();
                    break;
                case 6:
                    salir = true;
                  
                    break;
                default:
                    System.out.println("Debe elegir una opción entre la 1 y la 6");
            }
            
        }
        System.out.println("Hasta luego");
        pararAplicacion();
	}
	
	public void pararAplicacion() {
		SpringApplication.exit(context, () -> 0);
	}
	
	//menú para el cliente
	public void menu() {
		System.out.println("\n|====================================|");
        System.out.println("|         Menú de Biblioteca         |");
        System.out.println("|====================================|");
        System.out.println("| [1] Dar de alta un libro           |");
        System.out.println("| [2] Dar de baja un libro por ID    |");
        System.out.println("| [3] Modificar un libro por ID      |");
        System.out.println("| [4] Obtener un libro por ID        |");
        System.out.println("| [5] Listar todos los libros        |");
        System.out.println("| [6] Salir                          |");
        System.out.println("|====================================|");
        System.out.print("\nElige una opción: ");
	}
	
	public void altaLibro() {
		Scanner scanner = new Scanner(System.in);
		System.out.println("Introduzca un ID para el libro:");
		int id = scanner.nextInt();
		System.out.println("Introduzca el título del libro:");
		String titulo = scanner.next();
		System.out.println("Introduzca la editorial del libro:");
		String editorial = scanner.next();
		System.out.println("Introduzca una nota sobre el libro:");
		String nota = scanner.next();
		
		Libro libro = new Libro(id, titulo, editorial, nota);
		
		spl.alta(libro);
	}
	
	public void bajaLibro() {
		Scanner scanner = new Scanner(System.in);
		System.out.println("Introduzca el ID del libro que desea dar de baja:");
		int id = scanner.nextInt();
		spl.borrar(id);
	}
	
	public void modificarLibro() {
		Scanner scanner = new Scanner(System.in);
		System.out.println("Introduzca el ID del libro que desea modificar:");
		int id = scanner.nextInt();
		System.out.println("Introduzca el título del nuevo libro:");
		String titulo = scanner.next();
		System.out.println("Introduzca la editorial del nuevo libro:");
		String editorial = scanner.next();
		System.out.println("Introduzca una nota sobre el nuevo libro:");
		String nota = scanner.next();
		
		Libro libro = new Libro(id, titulo, editorial, nota);
		
		spl.modificar(libro);
	}
	
	public void obtenerLibro() {
		Scanner scanner = new Scanner(System.in);
		System.out.println("Introduzca el ID del libro que desea obtener:");
		int id = scanner.nextInt();
		spl.obtener(id);
	}
	
	public void listarLibreria() {
		spl.listar();
	}
	
	
}
